webpackJsonp([1],{0:function(e,t){},KpRO:function(e,t){},MDHA:function(e,t){},MOyW:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("tvR6");var a=n("qBF2"),i=n.n(a),o=n("7+uW"),l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]},s=n("VU/8")({name:"App"},l,!1,null,null,null).exports,r=n("/ocq"),c=n("mtWM"),d=n.n(c),u=n("mw3O"),p=n.n(u),m={components:{},name:"Login",data:function(){return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,trigger:"blur",validator:function(e,t,n){n()}}],password:[{required:!0,trigger:"blur",validator:function(e,t,n){t.length<1?n(new Error("The password can not be less than 1 digits")):n()}}]},passwordType:"password",loading:!1,showDialog:!1}},methods:{showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},handleLogin:function(){var e=this;this.$refs.loginForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0;e.$http.post("http://121.41.92.64:7705/login/",{user_name:e.loginForm.username,password:e.loginForm.password},{emulateJSON:!0}).then(function(e){if(0===e.data.state_code){var t=e.data.data.api_key;this.loading=!1,this.$router.push({path:"/admin",query:{api_key:t}})}else e.data.state_code,console.log(error),this.loading=!1}).catch(function(e){console.log(e),this.loading=!1})})},afterQRScan:function(){}},created:function(){},destroyed:function(){}},h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container"},[n("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{autoComplete:"on",model:e.loginForm,rules:e.loginRules,"label-position":"left"}},[n("div",{staticClass:"title-container"},[n("h3",{staticClass:"title"},[e._v("智眼销售管理系统")])]),e._v(" "),n("el-form-item",{attrs:{prop:"username"}},[n("span",{staticClass:"svg-container svg-container_login"}),e._v(" "),n("el-input",{attrs:{name:"username",type:"text",autoComplete:"on",placeholder:"用户名"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("span",{staticClass:"svg-container"}),e._v(" "),n("el-input",{attrs:{name:"password",type:e.passwordType,autoComplete:"on",placeholder:"密码"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleLogin(t):null}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),e._v(" "),n("span",{staticClass:"show-pwd",on:{click:e.showPwd}})],1),e._v(" "),n("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登陆\n    ")]),e._v(" "),n("div",{staticClass:"tips"},[n("span",[e._v("内测阶段")])]),e._v(" "),n("el-button",{staticClass:"thirdparty-button",attrs:{type:"primary"},on:{click:function(t){e.showDialog=!0}}},[e._v("第三方")])],1)],1)},staticRenderFns:[]};var f=n("VU/8")(m,h,!1,function(e){n("MDHA"),n("dskF")},"data-v-5312e866",null).exports,_=n("mvHQ"),v=n.n(_),y=n("woOf"),g=n.n(y),w=(n("ctMr"),{bind:function(e,t){e.addEventListener("click",function(n){var a=g()({},t.value),i=g()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),o=i.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var l=o.getBoundingClientRect(),s=o.querySelector(".waves-ripple");switch(s?s.className="waves-ripple":((s=document.createElement("span")).className="waves-ripple",s.style.height=s.style.width=Math.max(l.width,l.height)+"px",o.appendChild(s)),i.type){case"center":s.style.top=l.height/2-s.offsetHeight/2+"px",s.style.left=l.width/2-s.offsetWidth/2+"px";break;default:s.style.top=n.pageY-l.top-s.offsetHeight/2-document.body.scrollTop+"px",s.style.left=n.pageX-l.left-s.offsetWidth/2-document.body.scrollLeft+"px"}return s.style.backgroundColor=i.color,s.className="waves-ripple z-active",!1}},!1)}}),b=function(e){e.directive("waves",w)};window.Vue&&(window.waves=w,Vue.use(b)),w.install=b;var k=w;function x(e,t){console.log(e,t),e=e.addDays(1),t=t.addDays(1);for(var n=new Array,a=e;a<=t;)n.push(new Date(a)),a=a.addDays(1);return n}Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};var C={name:"SalesRecord",directives:{waves:k},data:function(){return{currentRecordDetails:null,host:"http://121.41.92.64:7705/",tableKey:0,list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,canteen:{},machine:{machine_id:-1,machine_name:"全部"},meal:{index:-1,name:"全部"},daterange:[new Date((new Date).toDateString()),new Date((new Date).toDateString())],type:void 0,sort:"+id"},canteenList:[],machineOptions:[{machine_id:-1,machine_name:"全部"}],mealOptions:[{index:-1,name:"全部"},{index:1,name:"早饭"},{index:2,name:"午饭"},{index:3,name:"晚饭"}],downloadLoading:!1}},filters:{statusFilter:function(e){return{published:"success",draft:"info",deleted:"danger"}[e]},typeFilter:function(e){return calendarTypeKeyValue[e]},parseDate:function(e){return e.split(" ")[0]},parseTime:function(e){return e.split(" ")[1]}},mounted:function(){console.log("this.$route.params",this.$route.query),this.api_key=this.$route.query.api_key,console.log(this.api_key),this.getCanteenList(),this.getMachineList()},methods:{handleDetails:function(e){this.$router.push({path:"/admin/recordDetails",query:{api_key:this.api_key,record_id:e.record_id}})},addRecord:function(){this.$http.post("http://121.41.92.64:7705/salerecord/add_/",{headers:{"api-key":this.api_key,"Content-Type":"application/x-www-form-urlencoded","machine-id":this.listQuery.machine.machine_id}},{emulateJSON:!0}).then(function(e){console.log(e)}).catch(function(e){})},getCanteenList:function(){var e=this;this.$http.get(this.host+"canteen/list/",{headers:{"api-key":this.api_key,"Content-Type":"application/x-www-form-urlencoded"}},{emulateJSON:!0}).then(function(t){console.log(t),e.canteenList=t.body.data.canteen}).catch(function(t){e.listLoading=!1})},getMachineList:function(){var e=this;this.listLoading=!0,this.$http.get("http://121.41.92.64:7705/machine/list/",{headers:{"api-key":this.api_key,"Content-Type":"application/x-www-form-urlencoded","canteen-id":"9"}},{emulateJSON:!0}).then(function(t){e.listLoading=!1,e.listLoading=!0;var n=t.data.data;e.machineOptions=n.concat({machine_id:-1,machine_name:"全部"}),e.handleFilter()}).catch(function(t){e.listLoading=!1})},handleFilter:function(){var e=this;console.log("listQuery",this.listQuery);var t=this.listQuery,n=t.machine,a=t.meal,i=t.daterange,o=[];console.log(n,this.machineOptions),o=-1==n.machine_id?this.machineOptions.filter(function(e){return e.machine_id>=0}).map(function(e){return e.machine_id}):[n.machine_id],console.log(o);var l=[];l=-1==a.index?this.mealOptions.filter(function(e){return e.index>=0}).map(function(e){return e.index}):[a.index],i=x(i[0],i[1]).map(function(e){return e.toISOString().slice(0,10)}),this.listLoading=!0,console.log(this.listQuery.machine),this.$http.post("http://121.41.92.64:7705/salerecord/query_/",p.a.stringify({meal_filter:v()(l),date_filter:v()(i),machine_filter:v()(o)}),{headers:{"api-key":this.api_key,"Content-Type":"application/x-www-form-urlencoded"}},{emulateHTTP:!0}).then(function(t){e.listLoading=!1,e.list=t.body.data}).catch(function(t){e.listLoading=!1})},handleDownload:function(){var e=this;console.log("listQuery");var t=this.listQuery,n=t.machine,a=t.meal,i=t.daterange,o=[];console.log(n,this.machineOptions),o=-1==n.machine_id?this.machineOptions.filter(function(e){return e.machine_id>=0}).map(function(e){return e.machine_id}):[n.machine_id],console.log(o);var l=[];l=-1==a.index?this.mealOptions.filter(function(e){return e.index>=0}).map(function(e){return e.index}):[a.index],i=x(i[0],i[1]).map(function(e){return e.toISOString().slice(0,10)}),this.$http.post("http://121.41.92.64:7705/salerecord/generate_sheet/",p.a.stringify({meal_filter:v()(l),date_filter:v()(i),machine_filter:v()(o)}),{responseType:"blob",headers:{"api-key":this.api_key,"Content-Type":"application/x-www-form-urlencoded"}},{emulateHTTP:!0}).then(function(e){console.log("res",e);var t=e.bodyBlob,n=new Blob([t]),a=document.createElement("a");a.download="汇总表.xls",a.style.display="none",a.href=URL.createObjectURL(n),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}).catch(function(t){e.listLoading=!1})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?parseTime(t[e]):t[e]})})}}},F={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{clearable:"","value-key":"canteen_name",placeholder:"餐厅选择"},model:{value:e.listQuery.canteen,callback:function(t){e.$set(e.listQuery,"canteen",t)},expression:"listQuery.canteen"}},e._l(e.canteenList,function(e){return n("el-option",{key:e.canteen_id,attrs:{label:e.canteen_name,value:e.canteen_name}})})),e._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{clearable:"","value-key":"machine_id",placeholder:"机器选择"},model:{value:e.listQuery.machine,callback:function(t){e.$set(e.listQuery,"machine",t)},expression:"listQuery.machine"}},e._l(e.machineOptions,function(e){return n("el-option",{key:e.machine_id,attrs:{label:e.machine_name,value:e}})})),e._v(" "),n("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","default-time":["00:00:00","23:59:59"]},model:{value:e.listQuery.daterange,callback:function(t){e.$set(e.listQuery,"daterange",t)},expression:"listQuery.daterange"}}),e._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{clearable:"","value-key":"name",placeholder:"饭时选择"},model:{value:e.listQuery.meal,callback:function(t){e.$set(e.listQuery,"meal",t)},expression:"listQuery.meal"}},e._l(e.mealOptions,function(e){return n("el-option",{key:e.index,attrs:{label:e.name,value:e}})})),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("查询")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.AddRecord}},[e._v("添加记录")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{download:"Acme Documentation (ver. 2.0.1).txt",type:"primary",loading:e.downloadLoading,icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("统计报表导出\n      ")])],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%","text-align":"center"},attrs:{stripe:"",data:e.list,border:"",fit:"","highlight-current-row":"",center:"all"}},[n("el-table-column",{attrs:{align:"center",label:"ID",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.record_id))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("parseDate")(t.row.datetime)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("parseTime")(t.row.datetime)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"总价"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.price_sum))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"详情"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){e.handleDetails(t.row)}}},[e._v("查看详情")])]}}])})],1)],1)},staticRenderFns:[]};var $=n("VU/8")(C,F,!1,function(e){n("jclU")},"data-v-94a9eaae",null).exports,L=n("Dd8w"),D=n.n(L),S={data:function(){return{api_key:"",host:"http://121.41.92.64:7705/",inputColumn:{default:"请输入内容"},menuList:[{editFlag:!1,food_name:"土豆牛肉",food_special:"123",food_type:"456",food_element:"789"}]}},mounted:function(){this.api_key=this.$route.query.api_key},methods:{handleEdit:function(e){e.editFlag=!0,console.log(e),this.inputColumn=D()({},this.inputColumn,e)},handleUpload:function(e){e.row.editFlag=!1,this.menuList[e.$index]=D()({},this.menuList[e.$index],this.inputColumn),console.log(this.menuList[e.$index]),this.addFood(this.menuList[e.$index])},handleDelete:function(e){},handleCancel:function(e){e.editFlag=!1,this.inputColumn={default:"请输入内容"}},addFood:function(e){delete e.editFlag,delete e.default,e=p.a.stringify(e),console.log(e),this.$http.post("http://121.41.92.64:7705/menu/add/",e,{headers:{"Content-Type":"application/x-www-form-urlencoded","api-key":this.api_key,"canteen-id":"9"}},{emulateJSON:!0}).then(function(e){console.log(e)})}}},O={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"container"}},[n("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.menuList,border:"",fit:"",center:"all"}},[n("el-table-column",{staticStyle:{display:"none"},attrs:{align:"center",fixed:"",label:"菜品编号"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",fixed:"",prop:"food_name",label:"菜名"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editFlag?e._e():n("span",[e._v(e._s(t.row.food_name))]),e._v(" "),t.row.editFlag?n("span",[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.inputColumn.food_name,callback:function(t){e.$set(e.inputColumn,"food_name",t)},expression:"inputColumn.food_name"}})],1):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",fixed:"",label:"价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editFlag?e._e():n("span",[e._v(e._s(t.row.food_price))]),e._v(" "),t.row.editFlag?n("span",[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.inputColumn.food_price,callback:function(t){e.$set(e.inputColumn,"food_price",t)},expression:"inputColumn.food_price"}})],1):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",fixed:"",label:"卡路里"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editFlag?e._e():n("span",[e._v(e._s(t.row.food_calorie))]),e._v(" "),t.row.editFlag?n("span",[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.inputColumn.food_calorie,callback:function(t){e.$set(e.inputColumn,"food_calorie",t)},expression:"inputColumn.food_calorie"}})],1):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"",align:"center",label:"风味"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editFlag?e._e():n("span",[e._v(e._s(t.row.food_special))]),e._v(" "),t.row.editFlag?n("span",[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.inputColumn.food_special,callback:function(t){e.$set(e.inputColumn,"food_special",t)},expression:"inputColumn.food_special"}})],1):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"",align:"center",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editFlag?e._e():n("span",[e._v(e._s(t.row.food_type))]),e._v(" "),t.row.editFlag?n("span",[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.inputColumn.food_type,callback:function(t){e.$set(e.inputColumn,"food_type",t)},expression:"inputColumn.food_type"}})],1):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"",align:"center",label:"成分"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editFlag?e._e():n("span",[e._v(e._s(t.row.food_element))]),e._v(" "),t.row.editFlag?n("span",[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.inputColumn.food_element,callback:function(t){e.$set(e.inputColumn,"food_element",t)},expression:"inputColumn.food_element"}})],1):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"",align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.editFlag,expression:"!scope.row.editFlag"}],attrs:{type:"text",size:"small"},on:{click:function(n){e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.editFlag,expression:"scope.row.editFlag"}],attrs:{type:"text",size:"small"},on:{click:function(n){e.handleUpload(t)}}},[e._v("上传")]),e._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.editFlag,expression:"!scope.row.editFlag"}],attrs:{type:"text",size:"small"},on:{click:function(n){e.handleDelete(t)}}},[e._v("删除")]),e._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.editFlag,expression:"scope.row.editFlag"}],attrs:{type:"text",size:"small"},on:{click:function(n){e.handleCancel(t.row)}}},[e._v("取消\n          ")])]}}])})],1)],1)},staticRenderFns:[]};var R=n("VU/8")(S,O,!1,function(e){n("cHew")},null,null).exports,T={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"container"}},[t("el-menu",{attrs:{"default-active":this.activeIndex,mode:"horizontal"},on:{select:this.handleSelect}},[t("el-menu-item",{attrs:{index:"/admin/saleRecord"}},[this._v("\n      销售记录\n      ")]),this._v(" "),t("el-menu-item",{attrs:{index:"/admin/menuManage"}},[this._v("\n      菜单管理\n    ")])],1),this._v(" "),t("router-view")],1)},staticRenderFns:[]};var Q=n("VU/8")({name:"admin",data:function(){return{activeIndex:"/admin/saleRecord",api_key:null}},mounted:function(){this.api_key=this.$route.query.api_key,this.$router.push({path:this.activeIndex,query:{api_key:this.api_key}})},methods:{handleSelect:function(e){this.$router.push({path:e,query:{api_key:this.api_key}})}}},T,!1,function(e){n("MOyW")},null,null).exports,N={data:function(){return{currentRecordDetails:null}},mounted:function(){var e=this.$route.query;this.api_key=e.api_key,this.record_id=e.record_id,console.log(e),this.getDetails()},methods:{getDetails:function(){var e=this;this.$http.post("http://121.41.92.64:7705/salerecord/detail/query/",p.a.stringify({record_id:this.record_id}),{headers:{"api-key":this.api_key,"Content-Type":"application/x-www-form-urlencoded"}},{emulateHTTP:!0}).then(function(t){e.currentRecordDetails=t.body.data}).catch(function(e){})}}},q={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:this.currentRecordDetails}},[t("el-table-column",{attrs:{prop:"name",label:"菜名",width:"180"}}),this._v(" "),t("el-table-column",{attrs:{prop:"price",label:"价格",width:"180"}})],1)],1)},staticRenderFns:[]};var M=n("VU/8")(N,q,!1,function(e){n("KpRO")},null,null).exports;o.default.use(r.a);var U=new r.a({routes:[{path:"/admin",name:"admin",component:Q,children:[{path:"/admin/recordDetails",component:M},{path:"/admin/menuManage",component:R},{path:"/admin/saleRecord",component:$}]},{path:"/login",name:"Login",component:f}]}),E=n("8+8L");o.default.use(E.a),d.a.defaults.baseURL="http://121.41.92.64:7705",o.default.use(i.a,{size:"medium"}),o.default.config.productionTip=!1,new o.default({el:"#app",router:U,components:{App:s},template:"<App/>"})},cHew:function(e,t){},ctMr:function(e,t){},dskF:function(e,t){},jclU:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.872af096c5f2448c5f59.js.map